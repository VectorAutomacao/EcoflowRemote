package view;

import control.ControlarAplicativo;
import java.awt.Toolkit;
import java.util.ArrayList;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;
import model.SerialCom;

public class TelaPrincipal extends javax.swing.JFrame {
    
    private ControlarAplicativo controleAplicativo = new ControlarAplicativo();

    public TelaPrincipal() {
        initComponents();
        listaSerialCom();
        setIcon();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jToggleButton1 = new javax.swing.JToggleButton();
        jDesktopPane1 = new javax.swing.JDesktopPane();
        lbPorta = new javax.swing.JLabel();
        cbPortas = new javax.swing.JComboBox<>();
        lbSlaveadd = new javax.swing.JLabel();
        lbInitialregister = new javax.swing.JLabel();
        lbInitialinput = new javax.swing.JLabel();
        lbMaxpulses = new javax.swing.JLabel();
        lbRegsize = new javax.swing.JLabel();
        lbBaudrate = new javax.swing.JLabel();
        lbStopbits = new javax.swing.JLabel();
        lbParity = new javax.swing.JLabel();
        lbFormat = new javax.swing.JLabel();
        btnAplicar = new javax.swing.JButton();
        btnPadrao = new javax.swing.JButton();
        txtSlaveadd = new javax.swing.JTextField();
        txtInitialRegister = new javax.swing.JTextField();
        txtInitialInput = new javax.swing.JTextField();
        txtMaxpulses = new javax.swing.JTextField();
        txtRegSize = new javax.swing.JTextField();
        txtBaudrate = new javax.swing.JTextField();
        txtParity = new javax.swing.JTextField();
        txtFormat = new javax.swing.JTextField();
        txtStopBits = new javax.swing.JTextField();
        btnFinalizar = new javax.swing.JButton();
        btnSelecionar = new javax.swing.JButton();
        btnAtualizar = new javax.swing.JButton();
        btnLeitura = new javax.swing.JButton();
        lbStatus = new javax.swing.JLabel();
        jSeparator2 = new javax.swing.JSeparator();

        jToggleButton1.setText("jToggleButton1");

        javax.swing.GroupLayout jDesktopPane1Layout = new javax.swing.GroupLayout(jDesktopPane1);
        jDesktopPane1.setLayout(jDesktopPane1Layout);
        jDesktopPane1Layout.setHorizontalGroup(
            jDesktopPane1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );
        jDesktopPane1Layout.setVerticalGroup(
            jDesktopPane1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("ECOflow v0.6.0");
        setIconImages(null);
        setName("framePrincipal"); // NOI18N
        setResizable(false);

        lbPorta.setText("Selecionar Porta:");

        cbPortas.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbPortas.setNextFocusableComponent(btnSelecionar);

        lbSlaveadd.setText("Slaveadd:");

        lbInitialregister.setText("Initialregister:");

        lbInitialinput.setText("Initialinput:");

        lbMaxpulses.setText("Maxpulses:");

        lbRegsize.setText("Regsize:");

        lbBaudrate.setText("Baudrate:");

        lbStopbits.setText("Stopbits:");

        lbParity.setText("Parity:");

        lbFormat.setText("Format:");

        btnAplicar.setMnemonic('A');
        btnAplicar.setText("Aplicar");
        btnAplicar.setEnabled(false);
        btnAplicar.setNextFocusableComponent(btnLeitura);
        btnAplicar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                btnAplicarMousePressed(evt);
            }
        });
        btnAplicar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAplicarActionPerformed(evt);
            }
        });
        btnAplicar.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnAplicarKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                btnAplicarKeyReleased(evt);
            }
        });

        btnPadrao.setMnemonic('d');
        btnPadrao.setText("Padr√£o");
        btnPadrao.setEnabled(false);
        btnPadrao.setNextFocusableComponent(btnAplicar);
        btnPadrao.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                btnPadraoMousePressed(evt);
            }
        });
        btnPadrao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPadraoActionPerformed(evt);
            }
        });
        btnPadrao.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnPadraoKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                btnPadraoKeyReleased(evt);
            }
        });

        txtSlaveadd.setEnabled(false);
        txtSlaveadd.setNextFocusableComponent(btnPadrao);
        txtSlaveadd.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtSlaveaddKeyTyped(evt);
            }
        });

        txtInitialRegister.setEnabled(false);

        txtInitialInput.setEnabled(false);

        txtMaxpulses.setEnabled(false);

        txtRegSize.setEnabled(false);

        txtBaudrate.setEnabled(false);

        txtParity.setEnabled(false);

        txtFormat.setEnabled(false);

        txtStopBits.setEnabled(false);

        btnFinalizar.setMnemonic('F');
        btnFinalizar.setText("Finalizar");
        btnFinalizar.setEnabled(false);
        btnFinalizar.setNextFocusableComponent(cbPortas);
        btnFinalizar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnFinalizarActionPerformed(evt);
            }
        });
        btnFinalizar.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnFinalizarKeyPressed(evt);
            }
        });

        btnSelecionar.setMnemonic('S');
        btnSelecionar.setText("Selecionar");
        btnSelecionar.setNextFocusableComponent(txtSlaveadd);
        btnSelecionar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                btnSelecionarMousePressed(evt);
            }
        });
        btnSelecionar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSelecionarActionPerformed(evt);
            }
        });
        btnSelecionar.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnSelecionarKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                btnSelecionarKeyReleased(evt);
            }
        });

        btnAtualizar.setMnemonic('t');
        btnAtualizar.setText("Atualizar");
        btnAtualizar.setNextFocusableComponent(cbPortas);
        btnAtualizar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAtualizarActionPerformed(evt);
            }
        });
        btnAtualizar.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnAtualizarKeyPressed(evt);
            }
        });

        btnLeitura.setMnemonic('e');
        btnLeitura.setText("Leituras");
        btnLeitura.setEnabled(false);
        btnLeitura.setNextFocusableComponent(btnFinalizar);
        btnLeitura.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                btnLeituraMousePressed(evt);
            }
        });
        btnLeitura.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLeituraActionPerformed(evt);
            }
        });
        btnLeitura.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnLeituraKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                btnLeituraKeyReleased(evt);
            }
        });

        lbStatus.setBackground(new java.awt.Color(255, 255, 255));
        lbStatus.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        lbStatus.setBorder(javax.swing.BorderFactory.createEmptyBorder(1, 2, 2, 1));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lbPorta)
                            .addComponent(btnFinalizar, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 80, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                .addComponent(btnAtualizar)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnSelecionar))
                            .addComponent(cbPortas, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(lbSlaveadd)
                            .addComponent(lbInitialinput)
                            .addComponent(lbInitialregister)
                            .addComponent(lbMaxpulses)
                            .addComponent(lbRegsize)
                            .addComponent(lbBaudrate)
                            .addComponent(lbStopbits)
                            .addComponent(lbParity)
                            .addComponent(lbFormat))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtInitialRegister)
                            .addComponent(txtMaxpulses)
                            .addComponent(txtRegSize)
                            .addComponent(txtBaudrate)
                            .addComponent(txtParity)
                            .addComponent(txtStopBits)
                            .addComponent(txtFormat)
                            .addComponent(txtSlaveadd)
                            .addComponent(txtInitialInput))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(btnLeitura, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 80, Short.MAX_VALUE)
                            .addComponent(btnAplicar, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(btnPadrao, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                    .addComponent(lbStatus, javax.swing.GroupLayout.DEFAULT_SIZE, 258, Short.MAX_VALUE))
                .addContainerGap())
            .addComponent(jSeparator2)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbPorta)
                    .addComponent(cbPortas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(4, 4, 4)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnAtualizar)
                    .addComponent(btnSelecionar)
                    .addComponent(btnFinalizar))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbSlaveadd)
                    .addComponent(btnPadrao)
                    .addComponent(txtSlaveadd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbInitialregister)
                    .addComponent(btnAplicar)
                    .addComponent(txtInitialRegister, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbInitialinput)
                    .addComponent(txtInitialInput, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnLeitura))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbMaxpulses)
                    .addComponent(txtMaxpulses, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbRegsize)
                    .addComponent(txtRegSize, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbBaudrate)
                    .addComponent(txtBaudrate, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbStopbits)
                    .addComponent(txtStopBits, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbParity)
                    .addComponent(txtParity, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbFormat)
                    .addComponent(txtFormat, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(lbStatus, javax.swing.GroupLayout.PREFERRED_SIZE, 18, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        btnPadrao.getAccessibleContext().setAccessibleDescription("Aplica os valores padr√µes de configura√ß√µes");
        btnSelecionar.getAccessibleContext().setAccessibleDescription("");
        btnAtualizar.getAccessibleContext().setAccessibleDescription("");

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnAplicarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAplicarActionPerformed
        alterar();
    }//GEN-LAST:event_btnAplicarActionPerformed

    private void btnPadraoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPadraoActionPerformed
        padrao();
    }//GEN-LAST:event_btnPadraoActionPerformed

    private void btnFinalizarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFinalizarActionPerformed
        limpar();
        finalizar();
    }//GEN-LAST:event_btnFinalizarActionPerformed

    private void btnSelecionarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSelecionarActionPerformed
        selecionar();
    }//GEN-LAST:event_btnSelecionarActionPerformed

    private void btnAtualizarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAtualizarActionPerformed
        listaSerialCom();
    }//GEN-LAST:event_btnAtualizarActionPerformed

    private void btnLeituraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLeituraActionPerformed
        lbStatus.setText("Conclu√≠do");
        Leitura leitura = new Leitura(this, true, controleAplicativo);
        leitura.setVisible(true);
    }//GEN-LAST:event_btnLeituraActionPerformed

    private void btnSelecionarKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnSelecionarKeyPressed
      lbStatus.setText("Aguarde...");            
    }//GEN-LAST:event_btnSelecionarKeyPressed

    private void btnAtualizarKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnAtualizarKeyPressed
        if (evt.getKeyCode() == evt.VK_ENTER)
            listaSerialCom();
    }//GEN-LAST:event_btnAtualizarKeyPressed

    private void btnPadraoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnPadraoKeyPressed
        lbStatus.setText("Aguarde...");
    }//GEN-LAST:event_btnPadraoKeyPressed

    private void btnAplicarKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnAplicarKeyPressed
        lbStatus.setText("Aguarde...");
    }//GEN-LAST:event_btnAplicarKeyPressed

    private void btnLeituraKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnLeituraKeyPressed
        lbStatus.setText("Aguarde...");
    }//GEN-LAST:event_btnLeituraKeyPressed

    private void btnFinalizarKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnFinalizarKeyPressed
        if (evt.getKeyCode() == evt.VK_ENTER){
            limpar();
            finalizar();
        }
    }//GEN-LAST:event_btnFinalizarKeyPressed

    private void txtSlaveaddKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSlaveaddKeyTyped
        String caracteres="0987654321";//String com caractes validos
        //Verifica se caracter e valido
        if(!caracteres.contains(evt.getKeyChar()+"")){
            evt.consume();
        }
    }//GEN-LAST:event_txtSlaveaddKeyTyped

    private void btnSelecionarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnSelecionarMousePressed
        lbStatus.setText("Aguarde...");
    }//GEN-LAST:event_btnSelecionarMousePressed

    private void btnSelecionarKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnSelecionarKeyReleased
        if (evt.getKeyCode() == evt.VK_ENTER)
            selecionar();
    }//GEN-LAST:event_btnSelecionarKeyReleased

    private void btnPadraoMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnPadraoMousePressed
        lbStatus.setText("Aguarde...");
    }//GEN-LAST:event_btnPadraoMousePressed

    private void btnAplicarKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnAplicarKeyReleased
        if (evt.getKeyCode() == evt.VK_ENTER)
            alterar();
    }//GEN-LAST:event_btnAplicarKeyReleased

    private void btnAplicarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnAplicarMousePressed
        lbStatus.setText("Aguarde...");
    }//GEN-LAST:event_btnAplicarMousePressed

    private void btnPadraoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnPadraoKeyReleased
        if (evt.getKeyCode() == evt.VK_ENTER)
            padrao();
    }//GEN-LAST:event_btnPadraoKeyReleased

    private void btnLeituraKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnLeituraKeyReleased
        if (evt.getKeyCode() == evt.VK_ENTER){
            Leitura leitura = new Leitura(this, true, controleAplicativo);
            leitura.setVisible(true);
            lbStatus.setText("Conclu√≠do");
        }
    }//GEN-LAST:event_btnLeituraKeyReleased

    private void btnLeituraMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnLeituraMousePressed
        lbStatus.setText("Aguarde...");
    }//GEN-LAST:event_btnLeituraMousePressed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new TelaPrincipal().setVisible(true);
            }
        });
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAplicar;
    private javax.swing.JButton btnAtualizar;
    private javax.swing.JButton btnFinalizar;
    private javax.swing.JButton btnLeitura;
    private javax.swing.JButton btnPadrao;
    private javax.swing.JButton btnSelecionar;
    private javax.swing.JComboBox<String> cbPortas;
    private javax.swing.JDesktopPane jDesktopPane1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JToggleButton jToggleButton1;
    private javax.swing.JLabel lbBaudrate;
    private javax.swing.JLabel lbFormat;
    private javax.swing.JLabel lbInitialinput;
    private javax.swing.JLabel lbInitialregister;
    private javax.swing.JLabel lbMaxpulses;
    private javax.swing.JLabel lbParity;
    private javax.swing.JLabel lbPorta;
    private javax.swing.JLabel lbRegsize;
    private javax.swing.JLabel lbSlaveadd;
    private javax.swing.JLabel lbStatus;
    private javax.swing.JLabel lbStopbits;
    private javax.swing.JTextField txtBaudrate;
    private javax.swing.JTextField txtFormat;
    private javax.swing.JTextField txtInitialInput;
    private javax.swing.JTextField txtInitialRegister;
    private javax.swing.JTextField txtMaxpulses;
    private javax.swing.JTextField txtParity;
    private javax.swing.JTextField txtRegSize;
    private javax.swing.JTextField txtSlaveadd;
    private javax.swing.JTextField txtStopBits;
    // End of variables declaration//GEN-END:variables

    //**************************************************************************
    
    private void setIcon() {
        setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("ECOFlow.png")));
    }
    
    //**************************************************************************
    
    //Lista de portas de comunica√ß√£o ativas
    private void listaSerialCom(){
        DefaultComboBoxModel comboModel = (DefaultComboBoxModel) cbPortas.getModel();
        comboModel.removeAllElements();
        
        ArrayList<SerialCom> listas = controleAplicativo.getListaSerialCom();
        for(int i = 0; i < listas.size(); i++ ){
            SerialCom com = listas.get(i);
            comboModel.addElement(com.getNome() );
        }
    }
    
    //**************************************************************************
    
    //retorna as configura√ß√µes atuais
    private void selecionar(){
        //Verifica se porta COM selecionada e valida
        if(controleAplicativo.selecionarPorta((String) cbPortas.getSelectedItem()).equals("ok\r") ){
            //Ativar bot√µes e campos
            btnPadrao.setEnabled(true);
            btnAplicar.setEnabled(true);
            btnFinalizar.setEnabled(true);
            btnSelecionar.setEnabled(false);
            btnAtualizar.setEnabled(false);
            btnLeitura.setEnabled(true);
            txtSlaveadd.setEnabled(true);
            cbPortas.setEnabled(false);

            buscar();
        }else{
            JOptionPane.showMessageDialog(null, "Porta Selecionada inv√°lida!", "Alerta",JOptionPane.ERROR_MESSAGE);
            controleAplicativo.fechar();
        }
    }
    
    //**************************************************************************
    
    private void buscar(){        
        //Busca valor atual configurado
        txtSlaveadd.setText(controleAplicativo.comando("get slaveadd") );
        txtInitialRegister.setText(controleAplicativo.comando("get initialregister") );
        txtInitialInput.setText(controleAplicativo.comando("get initialinput") );
        txtMaxpulses.setText(controleAplicativo.comando("get maxpulses") );
        txtRegSize.setText(controleAplicativo.comando("get regsize") );
        txtBaudrate.setText(controleAplicativo.comando("get baudrate") );
        txtStopBits.setText(controleAplicativo.comando("get stopbits") );
        txtParity.setText(controleAplicativo.comando("get parity") );
        txtFormat.setText(controleAplicativo.comando("get format") );
        
        lbStatus.setText("Conclu√≠do");
    }
    
    //**************************************************************************
   
    //Aplica a nova configura√ß√£o
    private void alterar(){
        
        boolean verifica = true;
        
        //Verifica se textField n√£o e nulo
        if(!txtSlaveadd.getText().trim().equals("") ){
            if(!controleAplicativo.comando("set slaveadd " + txtSlaveadd.getText().trim() ).equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set initialregister 33").equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set initialinput 1").equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set maxpulses 999").equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set regsize 2").equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set baudrate 9600").equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set stopbits 1").equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set parity 0").equals("ok\r") )
                verifica = false;
            if(!controleAplicativo.comando("set format bin").equals("ok\r") )
                verifica = false;
            //Verifica-se todos os comandos foram enviado com sucesso
            if(verifica){
                //verifica se as altera√ß√µes foram salvas
                if(!controleAplicativo.comando("save").equals("ok\r") ){
                    JOptionPane.showMessageDialog(null, "Ocorreu um problema em salvar as configura√ß√µes! Tente novamente.",
                        "Alerta",JOptionPane.ERROR_MESSAGE);
                    controleAplicativo.fechar();
                }
            }else{
                JOptionPane.showMessageDialog(null, "Ocorreu um problema em alterar as configura√ß√µes! Tente novamente.",
                        "Alerta",JOptionPane.ERROR_MESSAGE);
                controleAplicativo.fechar();
            }
            buscar();
        }else{
            
            JOptionPane.showMessageDialog(null, "Preencha campo corretamente.", "Alerta", JOptionPane.ERROR_MESSAGE);
        }
        
    }
    
    //**************************************************************************
    
    private void padrao(){
        boolean verifica = true;
        
        //Aplica a configura√ß√£o padr√£o
        if(!controleAplicativo.comando("set slaveadd 1").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set initialregister 33").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set initialinput 1").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set maxpulses 999").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set regsize 2").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set baudrate 9600").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set stopbits 1").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set parity 0").equals("ok\r") )
            verifica = false;
        if(!controleAplicativo.comando("set format bin").equals("ok\r") )
            verifica = false;
        
        //Verifica-se todos os comandos foram enviado com sucesso
        if(verifica){
            //verifica se as altera√ß√µes foram salvas
            if(!controleAplicativo.comando("save").equals("ok\r") ){
                JOptionPane.showMessageDialog(null, "Ocorreu um problema em salvar as configura√ß√µes! Tente novamente.",
                    "Alerta",JOptionPane.ERROR_MESSAGE);
                controleAplicativo.fechar();
            }
        }else{
            JOptionPane.showMessageDialog(null, "Ocorreu um problema em alterar as configura√ß√µes! Tente novamente.",
                    "Alerta",JOptionPane.ERROR_MESSAGE);
            controleAplicativo.fechar();
        }
        buscar();
    }
    
    //**************************************************************************
    
    private void finalizar(){
        
        //Ativar e desativar bot√µes e campos
        btnPadrao.setEnabled(false);
        btnAplicar.setEnabled(false);
        btnFinalizar.setEnabled(false);
        btnSelecionar.setEnabled(true);
        btnAtualizar.setEnabled(true);
        btnLeitura.setEnabled(false);
        txtSlaveadd.setEnabled(false);
        cbPortas.setEnabled(true);
        
        controleAplicativo.fechar();
    }
    
    //**************************************************************************
    
    private void limpar(){
        //Limpar os dados dos campos
        txtSlaveadd.setText(null);
        txtInitialRegister.setText(null);
        txtInitialInput.setText(null);
        txtMaxpulses.setText(null);
        txtRegSize.setText(null);
        txtBaudrate.setText(null);
        txtStopBits.setText(null);
        txtParity.setText(null);
        txtFormat.setText(null);
        lbStatus.setText("");
    }
    
    //**************************************************************************

}
